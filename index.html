<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Application Assistant</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .lucide { display: inline-block; vertical-align: middle; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple icon components
        const SearchIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
        );

        const FileTextIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
            </svg>
        );

        const BriefcaseIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
            </svg>
        );

        const SettingsIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
        );

        const PlusIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const ExternalLinkIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                <polyline points="15 3 21 3 21 9"></polyline>
                <line x1="10" y1="14" x2="21" y2="3"></line>
            </svg>
        );

        const Loader2Icon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="animate-spin">
                <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
            </svg>
        );

        function JobApplicationAssistant() {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [webhookUrls, setWebhookUrls] = useState({
                jobSearch: '',
                resumeTailor: ''
            });
            const [applications, setApplications] = useState([]);
            const [loading, setLoading] = useState(false);
            const [searchQuery, setSearchQuery] = useState('');
            const [jobDescription, setJobDescription] = useState('');
            const [tailoredResume, setTailoredResume] = useState('');

            useEffect(() => {
                try {
                    const savedWebhooks = localStorage.getItem('webhookUrls');
                    const savedApps = localStorage.getItem('applications');
                    
                    if (savedWebhooks) {
                        setWebhookUrls(JSON.parse(savedWebhooks));
                    }
                    if (savedApps) {
                        setApplications(JSON.parse(savedApps));
                    }
                } catch (error) {
                    console.error('Error loading data:', error);
                }
            }, []);

            const saveWebhooks = () => {
                localStorage.setItem('webhookUrls', JSON.stringify(webhookUrls));
                alert('Webhook URLs saved!');
            };

            const handleJobSearch = async () => {
                if (!webhookUrls.jobSearch) {
                    alert('Please configure Job Search webhook URL in Settings');
                    return;
                }

                setLoading(true);
                try {
                    const response = await fetch(webhookUrls.jobSearch, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ query: searchQuery })
                    });
                    
                    const data = await response.json();
                    console.log('Search results:', data);
                    alert('Search completed! Check console for results');
                } catch (error) {
                    console.error('Search error:', error);
                    alert('Search failed. Check webhook URL and Make.com setup.');
                } finally {
                    setLoading(false);
                }
            };

            const handleTailorResume = async () => {
                if (!webhookUrls.resumeTailor) {
                    alert('Please configure Resume Tailor webhook URL in Settings');
                    return;
                }

                setLoading(true);
                try {
                    const response = await fetch(webhookUrls.resumeTailor, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ jobDescription })
                    });
                    
                    const data = await response.json();
                    setTailoredResume(data.tailoredResume || 'Resume tailored! Check your Google Drive.');
                    alert('Resume tailored successfully!');
                } catch (error) {
                    console.error('Tailor error:', error);
                    alert('Failed to tailor resume. Check webhook URL and Make.com setup.');
                } finally {
                    setLoading(false);
                }
            };

            const addApplication = (job = {}) => {
                const newApp = {
                    id: Date.now(),
                    company: job.company || 'New Company',
                    position: job.position || 'New Position',
                    status: 'saved',
                    dateAdded: new Date().toISOString(),
                    url: job.url || '',
                    notes: job.notes || ''
                };
                
                const updated = [...applications, newApp];
                setApplications(updated);
                localStorage.setItem('applications', JSON.stringify(updated));
            };

            const updateStatus = (id, newStatus) => {
                const updated = applications.map(app => 
                    app.id === id ? { ...app, status: newStatus } : app
                );
                setApplications(updated);
                localStorage.setItem('applications', JSON.stringify(updated));
            };

            const renderDashboard = () => (
                <div className="space-y-6">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div className="bg-blue-50 p-6 rounded-lg">
                            <div className="text-3xl font-bold text-blue-600">
                                {applications.filter(a => a.status === 'applied').length}
                            </div>
                            <div className="text-sm text-gray-600 mt-1">Applied</div>
                        </div>
                        <div className="bg-green-50 p-6 rounded-lg">
                            <div className="text-3xl font-bold text-green-600">
                                {applications.filter(a => a.status === 'interview').length}
                            </div>
                            <div className="text-sm text-gray-600 mt-1">Interviews</div>
                        </div>
                        <div className="bg-purple-50 p-6 rounded-lg">
                            <div className="text-3xl font-bold text-purple-600">
                                {applications.filter(a => a.status === 'saved').length}
                            </div>
                            <div className="text-sm text-gray-600 mt-1">Saved Jobs</div>
                        </div>
                    </div>

                    <div className="bg-white rounded-lg shadow">
                        <div className="p-4 border-b flex justify-between items-center">
                            <h3 className="font-semibold">Recent Applications</h3>
                            <button
                                onClick={() => addApplication()}
                                className="flex items-center gap-2 px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"
                            >
                                <PlusIcon /> Add Job
                            </button>
                        </div>
                        <div className="divide-y">
                            {applications.length === 0 ? (
                                <div className="p-8 text-center text-gray-500">
                                    No applications yet. Start by searching for jobs or adding one manually.
                                </div>
                            ) : (
                                applications.map(app => (
                                    <div key={app.id} className="p-4 hover:bg-gray-50">
                                        <div className="flex justify-between items-start">
                                            <div className="flex-1">
                                                <h4 className="font-semibold">{app.position}</h4>
                                                <p className="text-sm text-gray-600">{app.company}</p>
                                                <p className="text-xs text-gray-400 mt-1">
                                                    Added {new Date(app.dateAdded).toLocaleDateString()}
                                                </p>
                                            </div>
                                            <div className="flex items-center gap-2">
                                                <select
                                                    value={app.status}
                                                    onChange={(e) => updateStatus(app.id, e.target.value)}
                                                    className="px-3 py-1 border rounded text-sm"
                                                >
                                                    <option value="saved">Saved</option>
                                                    <option value="applied">Applied</option>
                                                    <option value="interview">Interview</option>
                                                    <option value="offer">Offer</option>
                                                    <option value="rejected">Rejected</option>
                                                </select>
                                                {app.url && (
                                                    <a
                                                        href={app.url}
                                                        target="_blank"
                                                        rel="noopener noreferrer"
                                                        className="text-blue-600 hover:text-blue-800"
                                                    >
                                                        <ExternalLinkIcon />
                                                    </a>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                </div>
            );

            const renderJobSearch = () => (
                <div className="space-y-6">
                    <div className="bg-white rounded-lg shadow p-6">
                        <h3 className="font-semibold mb-4">Search for Jobs</h3>
                        <div className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Job Search Query
                                </label>
                                <input
                                    type="text"
                                    value={searchQuery}
                                    onChange={(e) => setSearchQuery(e.target.value)}
                                    placeholder="e.g., software engineer remote"
                                    className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                />
                            </div>
                            <button
                                onClick={handleJobSearch}
                                disabled={loading || !searchQuery}
                                className="w-full flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed"
                            >
                                {loading ? (
                                    <>
                                        <Loader2Icon />
                                        Searching...
                                    </>
                                ) : (
                                    <>
                                        <SearchIcon />
                                        Search Jobs
                                    </>
                                )}
                            </button>
                        </div>
                        <div className="mt-4 p-4 bg-blue-50 rounded-lg text-sm text-gray-700">
                            <strong>Note:</strong> Configure your Make.com webhook in Settings to enable job search.
                        </div>
                    </div>
                </div>
            );

            const renderResumeTailor = () => (
                <div className="space-y-6">
                    <div className="bg-white rounded-lg shadow p-6">
                        <h3 className="font-semibold mb-4">Tailor Resume to Job</h3>
                        <div className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Paste Job Description
                                </label>
                                <textarea
                                    value={jobDescription}
                                    onChange={(e) => setJobDescription(e.target.value)}
                                    placeholder="Paste the full job description here..."
                                    rows={10}
                                    className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                />
                            </div>
                            <button
                                onClick={handleTailorResume}
                                disabled={loading || !jobDescription}
                                className="w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed"
                            >
                                {loading ? (
                                    <>
                                        <Loader2Icon />
                                        Tailoring Resume...
                                    </>
                                ) : (
                                    <>
                                        <FileTextIcon />
                                        Tailor Resume
                                    </>
                                )}
                            </button>
                        </div>
                        {tailoredResume && (
                            <div className="mt-4 p-4 bg-green-50 rounded-lg">
                                <h4 className="font-semibold text-green-900 mb-2">Result:</h4>
                                <p className="text-sm text-gray-700 whitespace-pre-wrap">{tailoredResume}</p>
                            </div>
                        )}
                        <div className="mt-4 p-4 bg-green-50 rounded-lg text-sm text-gray-700">
                            <strong>How it works:</strong>
                            <ul className="mt-2 space-y-1 list-disc list-inside">
                                <li>Your base resume is stored in Google Drive</li>
                                <li>Make.com sends the job description to Claude API</li>
                                <li>Claude tailors your resume to match the job requirements</li>
                                <li>The tailored version is saved to Google Drive</li>
                            </ul>
                        </div>
                    </div>
                </div>
            );

            const renderSettings = () => (
                <div className="space-y-6">
                    <div className="bg-white rounded-lg shadow p-6">
                        <h3 className="font-semibold mb-4">Make.com Webhook Configuration</h3>
                        <div className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Job Search Webhook URL
                                </label>
                                <input
                                    type="text"
                                    value={webhookUrls.jobSearch}
                                    onChange={(e) => setWebhookUrls({...webhookUrls, jobSearch: e.target.value})}
                                    placeholder="https://hook.us1.make.com/..."
                                    className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                />
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Resume Tailor Webhook URL
                                </label>
                                <input
                                    type="text"
                                    value={webhookUrls.resumeTailor}
                                    onChange={(e) => setWebhookUrls({...webhookUrls, resumeTailor: e.target.value})}
                                    placeholder="https://hook.us1.make.com/..."
                                    className="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                />
                            </div>

                            <button
                                onClick={saveWebhooks}
                                className="w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                            >
                                Save Settings
                            </button>
                        </div>

                        <div className="mt-6 p-4 bg-yellow-50 rounded-lg">
                            <h4 className="font-semibold text-yellow-900 mb-2">Setup Instructions:</h4>
                            <ol className="text-sm text-gray-700 space-y-2 list-decimal list-inside">
                                <li>Create scenarios in Make.com for each webhook</li>
                                <li>Set up Google Drive integration to read/write files</li>
                                <li>Add Claude API integration (you'll need an Anthropic API key)</li>
                                <li>Copy webhook URLs and paste them above</li>
                                <li>Test each webhook to ensure it's working</li>
                            </ol>
                        </div>
                    </div>

                    <div className="bg-white rounded-lg shadow p-6">
                        <h3 className="font-semibold mb-4">Data Management</h3>
                        <div className="space-y-3">
                            <button
                                onClick={() => {
                                    if (confirm('Clear all application data? This cannot be undone.')) {
                                        setApplications([]);
                                        localStorage.removeItem('applications');
                                    }
                                }}
                                className="w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
                            >
                                Clear All Applications
                            </button>
                            <p className="text-xs text-gray-500">
                                Note: Your resumes and job data in Google Drive will not be affected
                            </p>
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-white shadow">
                        <div className="max-w-6xl mx-auto px-4 py-4">
                            <h1 className="text-2xl font-bold text-gray-900">Job Application Assistant</h1>
                            <p className="text-sm text-gray-600 mt-1">AI-powered job search and application tracking</p>
                        </div>
                    </div>

                    <div className="max-w-6xl mx-auto px-4 py-6">
                        <div className="flex gap-2 mb-6 overflow-x-auto">
                            <button
                                onClick={() => setActiveTab('dashboard')}
                                className={`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap ${
                                    activeTab === 'dashboard' 
                                        ? 'bg-blue-600 text-white' 
                                        : 'bg-white text-gray-700 hover:bg-gray-100'
                                }`}
                            >
                                <BriefcaseIcon />
                                Dashboard
                            </button>
                            <button
                                onClick={() => setActiveTab('search')}
                                className={`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap ${
                                    activeTab === 'search' 
                                        ? 'bg-blue-600 text-white' 
                                        : 'bg-white text-gray-700 hover:bg-gray-100'
                                }`}
                            >
                                <SearchIcon />
                                Job Search
                            </button>
                            <button
                                onClick={() => setActiveTab('tailor')}
                                className={`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap ${
                                    activeTab === 'tailor' 
                                        ? 'bg-blue-600 text-white' 
                                        : 'bg-white text-gray-700 hover:bg-gray-100'
                                }`}
                            >
                                <FileTextIcon />
                                Resume Tailor
                            </button>
                            <button
                                onClick={() => setActiveTab('settings')}
                                className={`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap ${
                                    activeTab === 'settings' 
                                        ? 'bg-blue-600 text-white' 
                                        : 'bg-white text-gray-700 hover:bg-gray-100'
                                }`}
                            >
                                <SettingsIcon />
                                Settings
                            </button>
                        </div>

                        {activeTab === 'dashboard' && renderDashboard()}
                        {activeTab === 'search' && renderJobSearch()}
                        {activeTab === 'tailor' && renderResumeTailor()}
                        {activeTab === 'settings' && renderSettings()}
                    </div>
                </div>
            );
        }

        // Wait for DOM to be ready
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<JobApplicationAssistant />);
    </script>
</body>
</html>
